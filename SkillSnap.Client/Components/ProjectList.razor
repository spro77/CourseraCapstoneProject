@* ProjectList Component - Displays a list of projects *@
@using SkillSnap.Client.Models
@using SkillSnap.Client.Services
@inject ProjectService ProjectService

<div class="project-list">
    <h3>Projects</h3>

    @if (isLoading)
    {
        <p><em>Loading projects...</em></p>
    }
    else if (!projects.Any())
    {
        <p><em>No projects found. Add some data using the /api/seed endpoint!</em></p>
    }
    else
    {
        @foreach (var project in projects)
        {
            <div class="project-item">
                <img src="@project.ImageUrl" alt="@project.Title" class="project-image" />
                <div class="project-details">
                    <h4>@project.Title</h4>
                    <p>@project.Description</p>
                </div>
            </div>
        }
    }

    <div class="add-project-form">
        <h4>Add New Project</h4>
        <input type="text" @bind="newProject.Title" placeholder="Project Title" class="form-input" autocomplete="off" />
        <input type="text" @bind="newProject.Description" placeholder="Description" class="form-input" autocomplete="off" />
        <input type="text" @bind="newProject.ImageUrl" placeholder="Image URL" class="form-input" autocomplete="off" />
        <input type="number" @bind="newProject.PortfolioUserId" placeholder="User ID (default: 1)" class="form-input" autocomplete="off" />
        <button @onclick="AddProject" class="btn-add">Add Project</button>
    </div>
</div>

@code {
    private List<Project> projects = new List<Project>();
    private Project newProject = new Project { PortfolioUserId = 1 };
    private bool isLoading = true;

    protected override async Task OnInitializedAsync()
    {
        await LoadProjects();
    }

    private async Task LoadProjects()
    {
        isLoading = true;
        projects = await ProjectService.GetProjectsAsync();
        isLoading = false;
    }

    private async Task AddProject()
    {
        if (string.IsNullOrWhiteSpace(newProject.Title))
        {
            return;
        }

        var addedProject = await ProjectService.AddProjectAsync(newProject);
        if (addedProject != null)
        {
            await LoadProjects();
            newProject = new Project { PortfolioUserId = 1 };
        }
    }
}

<style>
    .project-list {
        padding: 1rem;
        max-width: 800px;
        margin: 0 auto;
    }

    .project-list h3 {
        font-size: 1.8rem;
        margin-bottom: 1rem;
        color: #333;
    }

    .project-item {
        display: flex;
        gap: 1rem;
        padding: 1rem;
        margin-bottom: 1rem;
        border: 1px solid #ddd;
        border-radius: 8px;
        background-color: #fff;
        transition: box-shadow 0.3s;
    }

    .project-item:hover {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .project-image {
        width: 100px;
        height: 100px;
        object-fit: cover;
        border-radius: 4px;
    }

    .project-details {
        flex: 1;
    }

    .project-details h4 {
        margin: 0 0 0.5rem 0;
        font-size: 1.3rem;
        color: #333;
    }

    .project-details p {
        margin: 0;
        color: #666;
        line-height: 1.5;
    }

    .add-project-form {
        margin-top: 2rem;
        padding: 1.5rem;
        border: 2px dashed #ddd;
        border-radius: 8px;
        background-color: #f9f9f9;
    }

    .add-project-form h4 {
        margin-top: 0;
        margin-bottom: 1rem;
        color: #333;
    }

    .form-input {
        display: block;
        width: 100%;
        padding: 0.5rem;
        margin-bottom: 0.75rem;
        border: 1px solid #ddd;
        border-radius: 4px;
        font-size: 1rem;
    }

    .btn-add {
        padding: 0.75rem 1.5rem;
        background-color: #4caf50;
        color: white;
        border: none;
        border-radius: 4px;
        font-size: 1rem;
        cursor: pointer;
        transition: background-color 0.3s;
    }

    .btn-add:hover {
        background-color: #45a049;
    }
</style>
